<main>
<%= render "shared/gallery", collection: @annonce.photos %>
<h1><%= @annonce.titre %></h1>
<%= @annonce.id %>
<div>
  <p><%= @annonce.description %></p>
</div>
<h2 id="dispos">Disponibilit√©s</h2>
<% if !params[:start_date].nil? %>
  <% date = Date.parse(params[:start_date]) %>
  <% prev = date.last_month.beginning_of_month.strftime('%Y-%m-%d') %>
  <% nexto = date.next_month().beginning_of_month.strftime('%Y-%m-%d') %>
<% else %>
  <% date = DateTime.now %>
  <% prev = date.last_month.beginning_of_month.strftime('%Y-%m-%d') %>
  <% nexto = date.next_month().beginning_of_month.strftime('%Y-%m-%d') %>
<% end %>
<aside id="calendar-links">
  <%= link_to renting_path(@annonce, start_date: prev, anchor: "calendar-links") do %>
    <i class="fas fa-chevron-left"></i>
  <% end %>
  <%= link_to renting_path(@annonce, start_date: nexto, anchor: "calendar-links") do %>
    <i class="fas fa-chevron-right"></i>
  <% end %>
</aside>
<section class="calendars">
  <% if !@annonce.airbnb.blank? %>
    <%= render "shared/calendar" %>



    <%= month_calendar start_date: date.next_month() do |date| %>
      <span class="date" data-day=<%= date %>><%= date.day %></span>
      <% @dates_renting.each do |date_day| %>
        <% if Date.strptime(date_day) == date && DateTime.parse(date_day) > DateTime.now - 1 %>
          <span class="blocked"></span>
        <% end %>
      <% end %>
    <% end %>

    <%= month_calendar start_date: date.next_month(3).beginning_of_week do |date| %>
      <span class="date" data-day=<%= date %>><%= date.day %></span>
      <% @dates_renting.each do |date_day| %>
        <% if Date.strptime(date_day) == date && DateTime.parse(date_day) > DateTime.now - 1 %>
          <span class="blocked"></span>
        <% end %>
      <% end %>
    <% end %>

  <% end %>
</section>

</main>
<%= javascript_pack_tag "blockedDates" %>
